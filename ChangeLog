2001-09-11  François Pinard  <pinard@iro.umontreal.ca>

	* pymacs.py (zombie): New, so to get a clear diagnostic.
	(zombie_python): Link objects to the above function.
	* pymacs.el (pymacs-terminate-services): Ask for confirmation if
	any object in LISP space is still in use on the Python side.
	* pymacs-test.el (try-lisp): Do not terminate the helper.

	* pymacs.py (Buffer): New class, yet empty for now.
	* pymacs.el (pymacs-print-for-eval): Use it.
	Reported by Brian McErlean.

	* pymacs.py (Table): New class.
	* pymacs.el (pymacs-print-for-eval): Use it.
	Reported by Brian McErlean.

	* pymacs.py (List, Vector): New classes, split out of Lisp class.
	* pymacs.el (pymacs-print-for-eval): Use them.
	(pymacs-lisp-length, pymacs-lisp-ref, pymacs-list-set):	Deleted.
	Reported by Brian McErlean.

	* pymacs.py (Server.loop): Allow keyboard interrupts through.

	* pymacs.el: Use Lisp instead of Handle.  Rename
	pymacs-handle-length to pymacs-lisp-length, pymacs-handle-ref to
	pymacs-lisp-ref, pymacs-handle-set o pymacs-lisp-set,
	pymacs-allocate-handle to pymacs-allocate-lisp and
	pymacs-free-handle to pymacs-free-lisp.

	* pymacs.py: Rename Lisp to Lisp_Interface, and Handle to Lisp.
	Adjust for other renamings above.

	* pymacs.el: Rename pymacs-id to pymacs-python.  Ajust for below.
	* pymacs.py: Rename handles to python, free_handles to
	free_python, zombie_handles to zombie_python and allocate_handle
	to allocate_python.

	* pymacs.el (pymacs-proper-list-p): New function.  Use it
	everywhere instead of listp, which is not what I thought it was!

	* pymacs.el (pymacs-serve-until-reply): In case of LISP error,
	transmit a list of one argument, instead of the argument itself,
	to print-for-apply.  This was preventing proper diagnostic.
	Correct a similar error for when expansion is requested.

	* pymacs.el (pymacs-print-for-eval):  Do not transmit a symbol
	by its name, when it comes from another oblist than the main one.

	* pymacs.py (print_lisp): Transmit pymacs-id as a dotted pair.
	* pymacs.el (pymacs-print-for-eval):  Adjusted.

	* pymacs.el (pymacs-print-for-eval): Use lisp[], not sym[].
	Avoid double escaping of the transmitted string in this case.
	Reported by Brian McErlean.

2001-09-10  François Pinard  <pinard@iro.umontreal.ca>

	* : Release 0.3.

	* pymacs.py (Server.send): Ensure an end of line after reply.
	* pymacs.el (pymacs-round-trip): Do not add one after Python replies.

	* pymacs.el (pymacs-round-trip): Check for vanishing helper process.
	(pymacs-serve-until-reply): Get text without catching errors, than
	eval. Else, protocol errors get reported back to Python.
	* pymacs.py (Server.ProtocolError): New.  Better than AssertError.
	If it occurs, get out of program, do not keep returning errors.
	Reported by Carey Evans.

	* pymacs.el (pymacs-round-trip): If point coincides with marker,
	just keep it that way as the buffer grows.

	* pymacs.el (pymacs-start-services): If the hash table already
	exists, inform the Python side of IDs that it should not reuse.
	Otherwise, old lambdas may randomly refer to new Python objects.
	(pymacs-terminate-services): Remember Python IDs, do not reset them.

	* pymacs.py (zombie_handles): New.

	* Makefile: Transmit $(pymacsdir) to pymacs-services.
	* pymacs-services: Handle it.

	* pymacs.py (print_lisp): Process an empty tuple properly.
	Reported by Carey Evans.

	* pymacs.el (pymacs-start-services): With run-at-time, use `20 20'
	instead of `t 20', so XEmacs is happy.
	Reported by Carey Evans.

	* pymacs.el (pymacs-start-services, pymacs-terminate-services):
	Use `post-gc-hook' if available, instead of using a timer.
	Reported by Gerd Möllman.

	* pymacs.py (Symbol.value, Symbol.copy): Add argument self.
	(print_lisp): Quote symbols if quoted=1.

2001-09-09  François Pinard  <pinard@iro.umontreal.ca>

	* pymacs.el (pymacs-defuns): New function.
	* pymacs.py: Use it.  This should allow faster imports.

	* Makefile, pymacs.el, pymacs.py: Use `(pymacs-version VERSION)',
	not `(started)'.  Check for version discrepancies.

	* Makefile: A bit more parameterization.

	* : Release 0.2, including ideas and suggestions from others.
	Reported by Brian McErlean, Carel Fellinger, Cedric Adjih,
	Marcin Qrczak Kowalczyk, Paul Winkler and Steffen Ries.

